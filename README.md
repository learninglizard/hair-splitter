# hair-splitter
IMSCC Common Cartridge File Splitter for Canvas by Instructure

#### INSTRUCTIONS ON HOW TO RUN

1.  Search for `Windows PowerShell ISE` in the start menu
2.  If there is no untitled blank file open press **Ctrl** + **R** to make one appear
3.  Copy and paste the contents into the ISE
       (The white background editor part... if it's missing, press **Ctrl** + **2**)
4.  Change the `$usrMaxImportFileSize` to the size you want your *.imscc files split by
5.  Then smash the green play button! (Or press `F5`)
6.  You should be able to upload the part files in order with the *.imscc file last<br>
       **IMPORTANT!**  Upload all the .zip part files files under the **`-courses-`** directory in Canvas
8.  Check your course, everything should be gtg

You may need to run in PowerShell 7 to support some Common Cartridge files depending on how the archive exported.
You can tell because the script will error and you'll receive a ton of null errors in the console

#///////////////////////////////#<br>
#### NOTES FROM THE AUTHOR:<br><br>
The output will be one *.imscc file and zero or more *.zip files<br><br>
The output files will be located in the same directory as your original imscc file.<br><br>
HOW IT WORKS<br>
The 'algorithm' works the same way as one might load groceries onto a conveyor belt at the supermarket.<br>
It sorts all files in the *.imscc from smallest to largest<br>
Then it begins filling the first 'grocery cart' with all the files your course must have<br>
until it finishes with mandatory files or moves on to your course's 'Files' folder<br>
It creates new 'grocery carts' as required and continues until it finishes copying all data.<br><br>
Importing the *.imscc file generated by this script into Canvas will generate errors.<br><br>
However, once you import all the zip file parts (*.zip), your course should be completely intact.<br><br>

Pull Requests are welcome :)
