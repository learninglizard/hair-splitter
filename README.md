# hair-splitter
IMSCC Common Cartridge File Splitter for Canvas by Instructure

#### WINDOWS INSTRUCTIONS

(Easiest method, but may have issues with some IMSCC files due to PowerShell bugs)
1.  Search for `Windows PowerShell ISE` in the start menu
2.  If there is no untitled blank file open press **Ctrl** + **R** to make one appear
3.  Copy and paste the contents into the ISE
       (The white background editor part... if it's missing, press **Ctrl** + **2**)
4.  If running in ISE change the `$MaxPartFileSize` to the size you want your *.imscc files split by.
5.  Then smash the green play button! (Or press `F5`)
6.  You should be able to upload the part files in order with the *.imscc file last<br>
       **IMPORTANT!**  Upload all the .zip part files files under the **`-courses-`** directory in Canvas
7.  Check your course, everything should be gtg

You may need to run in PowerShell 7 to support some Common Cartridge files depending on how the archive exported.<br>
You can tell because the script will error and you'll receive a ton of null errors in the console.<br>
1.  Install Powershell 7 from the Microsoft App Store: https://www.microsoft.com/store/productId/9MZ1SNWT0N5D<br>
2.  Save the PowerShell script by going to prject page https://github.com/learninglizard/hair-splitter<br>
3.  Right-Click on the .ps1 file and click **Save Link As** accept any browser warnings.<br>
4.  **SAVE TO YOUR DOWNLOADS FOLDER** (commands assume this is where the script is saved)<br>
5.  Launch PowerShell 7 by searching the StartMenu for "PowerShell"<br>
It should be listed as **PowerShell** (not Windows PowerShell), say **App** underneath and be a **black** icon instead of blue.<br>
6.  Run `powershell.exe -ExecutionPolicy UnRestricted -File $env:userprofile\Downloads\Hair-Splitter.ps1` in the console to run the script with default settings.<br>

Command-line options:
The script supports PowerShell parameters or switches.<br>
For example, you can run<br>
`powershell.exe -ExecutionPolicy UnRestricted -File $env:userprofile\Downloads\Hair-Splitter.ps1 1GB splitfiles`<br>
to generate 1GB part files which will be labeled `originalfilename (splitfiles 1)` etc.

#### APPLE INSTRUCTIONS
(Untested)
Install PowerShell via your preferred method:  https://docs.microsoft.com/en-us/powershell/scripting/install/installing-powershell-on-macos?view=powershell-7.2
Run using same commands as Windows.  Paths may need to be changed due to changes in MacOS directory structures.


#///////////////////////////////#<br>
#### NOTES FROM THE AUTHOR:<br><br>
The output will be one *.imscc file and zero or more *.zip files<br><br>
The output files will be located in the same directory as your original imscc file.<br><br>
HOW IT WORKS<br>
The 'algorithm' works the same way as one might load groceries onto a conveyor belt at the supermarket.<br>
It sorts all files in the *.imscc from smallest to largest<br>
Then it begins filling the first 'grocery cart' with all the files your course must have<br>
until it finishes with mandatory files or moves on to your course's 'Files' folder<br>
It creates new 'grocery carts' as required and continues until it finishes copying all data.<br><br>
Importing the *.imscc file generated by this script into Canvas will generate errors.<br><br>
However, once you import all the zip file parts (*.zip), your course should be completely intact.<br><br>

Pull Requests are welcome :)
